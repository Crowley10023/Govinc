<div th:fragment="mainNav">
  <div class="main-navigation">
    <div class="landing-main">
      <div class="landing-image">
        <img src="/title.png" style="width: 50px; padding: 10px" alt="Compliance Incubator Logo" class="ci-logo-img" />
      </div>
      <div style="flex:1;display:flex;flex-direction:column;gap:0.8em;">
        <div style="padding:6px 8px;color:#444;font-size:1em">User: <span
            th:text="${userName != null} ? ${userName} : (${userId != null} ? ${userId} : 'no user')"></span></div>
        <div style="margin-bottom:0.5em;display:flex;align-items:center;">
          <span class="ci-headline">compliance incubator</span>
          <a href="/" style="margin-left:1.25em;text-decoration:none;"><button type="button">Home</button></a>
          <!-- Select User Dropdown -->
          <form method="post" action="/users/set-session-user" style="margin-left:2em;">
            <label for="select-user">Select User:</label>
            <select id="select-user" name="userId" onchange="this.form.submit()">
              <option th:each="u : ${allUsers}" th:value="${u.id}" th:text="${u.name}" th:selected="${u.id == userId}"></option>
            </select>
            <!-- CSRF token placeholder for Spring Security -->
            <input type="hidden" th:if="${_csrf}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
          </form>
        </div>
        <style>
          .dropdown {
            position: relative;
            display: inline-block;
          }
          .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 230px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
            z-index: 1;
            border-radius: 4px;
            padding: 0.4em 0;
          }
          .dropdown-content a, .dropdown-content form {
            color: #333;
            padding: 8px 18px;
            text-decoration: none;
            display: block;
            background: none;
            border: none;
            width: 100%;
            text-align: left;
            font-size: 1em;
          }
          .dropdown:hover .dropdown-content {
            display: block;
            position: fixed;
          }
          .dropdown-content a:hover, .dropdown-content form:hover {
            background-color: #eaf3fa;
            color: #2274A5;
          }
        </style>
        <div class="nav-row" style="display:flex;flex-direction:row;align-items:center;gap:1.2em;">
          <div class="nav-entry" style="display:flex;align-items:center;gap:0.4em;">
            <span class="entry-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <ellipse cx="12" cy="12" rx="9" ry="6" stroke="#2274A5" stroke-width="2" fill="#eaf3fa" />
                <rect x="8" y="11" width="8" height="2" rx="1" fill="#2274A5" />
              </svg>
            </span>
            <a href="/assessment-urls-list" class="entry-link"><button type="button">Assessment URLs</button></a>
          </div>
          <div class="nav-entry" style="display:flex;align-items:center;gap:0.4em;">
            <span class="entry-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" stroke="#2274A5" stroke-width="2" fill="#eaf3fa" />
                <rect x="8" y="11" width="8" height="2" rx="1" fill="#2274A5" />
              </svg>
            </span>
            <form action="/assessment/create" method="get" class="entry-form" style="margin:0;">
              <button type="submit">Create Assessment</button>
            </form>
          </div>
          <div class="nav-entry" style="display:flex;align-items:center;gap:0.4em;">
            <a href="/assessment/list" class="entry-link"><button type="button">Assessments</button></a>
          </div>

          <!-- SECURITY FRAMEWORK DROPDOWN -->
          <div class="dropdown nav-entry">
            <button type="button" style="background:none;border:none;padding:0;font:inherit;cursor:pointer;display:inline-flex;align-items:center;gap:0.4em;">
              <span class="entry-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <ellipse cx="12" cy="12" rx="9" ry="6" stroke="#2274A5" stroke-width="2" fill="#eaf3fa" />
                  <rect x="8" y="11" width="8" height="2" rx="1" fill="#2274A5" />
                </svg>
              </span>
              Security Framework
            </button>
            <div class="dropdown-content">
              <a href="/security-control/list">Security Controls</a>
              <a href="/security-catalog/list">Security Catalogs</a>
              <a href="/maturitymodel/list">Maturity Models</a>
              <a href="/maturityanswer/list">Maturity Model Answers</a>
              <a href="/security-control-domain/list">Security Control Domains</a>
            </div>
          </div>

          <div class="nav-entry" style="display:flex;align-items:center;gap:0.4em;">
            <span class="entry-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="4" y="4" width="16" height="16" rx="4" stroke="#2274A5" stroke-width="2" fill="#eaf3fa" />
                <path d="M8 15V9M12 15V12M16 15V7" stroke="#2274A5" stroke-width="2" stroke-linecap="round" />
              </svg>
            </span>
            <a href="/statistics" class="entry-link"><button type="button">Statistics</button></a>
          </div>

          <!-- ORGANIZATION DROPDOWN -->
          <div class="dropdown nav-entry">
            <button type="button" style="background:none;border:none;padding:0;font:inherit;cursor:pointer;display:inline-flex;align-items:center;gap:0.4em;">
              <span class="entry-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect x="4" y="4" width="16" height="16" rx="4" stroke="#2274A5" stroke-width="2" fill="#eaf3fa" />
                  <path d="M8 15V9M12 15V12M16 15V7" stroke="#2274A5" stroke-width="2" stroke-linecap="round" />
                </svg>
              </span>
              Organization
            </button>
            <div class="dropdown-content">
              <a href="/users">Users</a>
              <a href="/orgunits/list">Org Units</a>
              <a href="/orgservices/list">Org Services</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>